angular.module("ng-slim-scroll",[]).directive("slimScroll",["$window","$document","$timeout",function(a,b,c){var d="data-slim-scroll-init",e={minHeight:25,wrapperClass:"slim-scroll-wrapper",scrollbarContainerClass:"slim-scroll-scrollbar-container",scrollbarClass:"slim-scroll-scrollbar",specialClass:"animate"};return{restrict:"A",transclude:!0,replace:!0,template:'<div><div class="slim-scroll-wrapper" data-ng-transclude></div></div>',link:function(f,g){g.removeAttr(d),c(function(){var c=g.children()[0],h=angular.element(c);if(c.offsetHeight<c.scrollHeight){g.attr(d,"1");var i=angular.extend({},e,g.data("options"));h.addClass(i.wrapperClass);var j=angular.element(a.document.createElement("div"));j.addClass(i.scrollbarContainerClass);var k=angular.element(a.document.createElement("div"));k.addClass(i.scrollbarClass),g.append(j),j.append(k);var l={},m=function(a){var b=document.documentElement.scrollTop;return a.getBoundingClientRect().top+(b?b:document.body.scrollTop)},n=function(a){var b=parseInt(k[0].style.top.replace("%",""))*a/100;return b?b:0},o=function(){l.height=j[0].offsetHeight,l.scrollHeight=c.scrollHeight,l.position=l.height/l.scrollHeight*100,l.scrollbarHeight=l.scrollHeight*l.height/100,l.scrollPosition=i.fixedHeight?i.fixedHeight/l.height*100:l.scrollbarHeight<i.minHeight?i.minHeight/l.height*100:l.position,l.remainder=100-l.scrollPosition,l.x=(l.scrollHeight-l.height)*((l.scrollPosition-l.position)/(100-l.position)),l.heightRate=Math.abs(l.x/l.remainder+l.scrollHeight/100),k[0].style.height=l.scrollPosition+"%",l.reposition=n(l.height)},p=function(a){a=a||event;var b=a.target||event.srcElement,d=b.parentElement||b.parentNode;if(l&&d!==j[0]){var e=a.pageY||event.clientY,f=(e-m(c.parentElement||c.parentNode))/l.height*100-l.scrollPosition/2;f>l.remainder?f=l.remainder:0>f&&(f=0),k[0].style.top=f+"%",c.scrollTop=f*l.heightRate,j.addClass(i.specialClass)}},q=function(d){var e=a.getSelection?a.getSelection():a.document.selection;e&&(e.removeAllRanges?e.removeAllRanges():e.empty&&e.empty()),d=d||event;d.currentTarget||d.srcElement;b.bind("mousemove",r),b.bind("mouseup",s),l.offsetTop=m(c),l.firstY=d.pageY||event.clientY,l.reposition||(l.reposition=n(l.height))},r=function(a){a=a||event;var b=a.pageY||a.clientY,d=(l.reposition+b-l.firstY)/l.height*100;l.remainder<d&&(d=l.remainder),l.previousTop||(l.previousTop=d+1);var e=d>=0&&l.firstY>l.offsetTop;(l.previousTop>d&&e||e&&c.scrollTop+l.height!==l.scrollHeight)&&(k[0].style.top=d+"%",l.previousTop=d,c.scrollTop=d*l.heightRate),j.removeClass(i.specialClass)},s=function(a){b.unbind("mousemove",r),b.unbind("mouseup",s),l.reposition=0,j.addClass(i.specialClass)},t=function(a){l&&(j.removeClass(i.specialClass),k[0].style.top=c.scrollTop/l.heightRate+"%",j.addClass(i.specialClass))};i.keepFocus&&(h.setAttr("tabindex","-1"),c.focus()),k.bind("mousedown",q),j.bind("click",p),h.bind("scroll",t),angular.element(a).bind("resize",o),o(),f.$on("$destroy",function(){k.unbind("mousedown"),j.unbind("click"),h.unbind("scroll"),angular.element(a).unbind("resize",o)})}})}}}]);